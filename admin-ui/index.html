<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Automatos Unified Adapter Admin</title>
    <link rel="stylesheet" href="./styles.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600&family=Sora:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body class="theme-shell">
    <div class="app-shell">
      <header class="top-bar">
        <div class="brand">
          <span class="brand-dot"></span>
          <div>
            <p class="brand-title">Automatos</p>
            <p class="brand-subtitle">Unified Adapter Admin</p>
          </div>
        </div>
        <div class="status-pill" id="connectionStatus">Disconnected</div>
      </header>

      <section class="hero">
        <div class="hero-copy glass-card">
          <h1>Unified Adapter Control Plane</h1>
          <p>
            Manage tools, OpenAPI sources, and credential modes with the same
            glass + orange glow aesthetic used across Automatos.
          </p>
          <div class="hero-actions">
            <button id="refreshTools" class="primary-btn">Refresh tools</button>
            <button id="openCreate" class="ghost-btn">Add tool</button>
          </div>
        </div>
        <div class="hero-panel glass-card">
          <h2>Connection</h2>
          <label>
            API Base URL
            <input id="baseUrl" type="text" placeholder="http://localhost:8000" />
          </label>
          <label>
            Admin Token
            <input id="authToken" type="password" placeholder="Bearer token" />
          </label>
          <div class="panel-actions">
            <button id="connectBtn" class="primary-btn">Connect</button>
            <button id="clearBtn" class="ghost-btn">Clear</button>
          </div>
          <p class="helper-text">
            Uses the adapter admin API: <code>/admin/tools</code>.
          </p>
        </div>
      </section>

      <section class="grid">
        <div class="glass-card table-card">
          <div class="table-header">
            <h2>Registered Tools</h2>
            <p>All tool metadata stored in the adapter database.</p>
          </div>
          <div id="toolsTable" class="table-body"></div>
        </div>
        <div class="glass-card side-panel">
          <h3>Quick Add Templates</h3>
          <div class="template-list">
            <button class="template" data-template="petstore">
              <span>Petstore</span>
              <small>Demo OpenAPI</small>
            </button>
            <button class="template" data-template="httpbin">
              <span>Httpbin</span>
              <small>Demo OpenAPI</small>
            </button>
            <button class="template" data-template="github">
              <span>GitHub</span>
              <small>Public REST spec</small>
            </button>
          </div>
          <div class="tips">
            <h4>Notes</h4>
            <ul>
              <li>Use BYO for demo calls without stored credentials.</li>
              <li>Hosted mode expects Automatos credential resolution.</li>
              <li>Changes require adapter restart to reload tools.</li>
            </ul>
          </div>
        </div>
      </section>

      <section class="logs glass-card">
        <div class="log-header">
          <h3>Activity Log</h3>
          <button id="clearLog" class="ghost-btn">Clear</button>
        </div>
        <div id="activityLog" class="log-body"></div>
      </section>
    </div>

    <div id="modalBackdrop" class="modal-backdrop hidden">
      <div class="modal glass-card">
        <header>
          <div>
            <h2 id="modalTitle">Create Tool</h2>
            <p id="modalSubtitle">Define tool metadata for the adapter.</p>
          </div>
          <button id="closeModal" class="ghost-btn">Close</button>
        </header>
        <form id="toolForm" class="modal-form">
          <div class="form-grid">
            <label>
              Name
              <input name="name" required />
            </label>
            <label>
              Provider
              <input name="provider" required />
            </label>
            <label>
              Category
              <input name="category" required />
            </label>
            <label>
              Adapter Type
              <select name="adapter_type">
                <option value="rest">REST</option>
                <option value="mcp">MCP</option>
              </select>
            </label>
            <label class="full">
              Description
              <input name="description" />
            </label>
            <label class="full">
              OpenAPI URL
              <input name="openapi_url" placeholder="https://..." />
            </label>
            <label class="full">
              Base URL
              <input name="base_url" placeholder="https://api.vendor.com" />
            </label>
            <label>
              Credential Mode
              <select name="credential_mode">
                <option value="hosted">Hosted</option>
                <option value="byo">BYO</option>
              </select>
            </label>
            <label>
              Enabled
              <select name="enabled">
                <option value="true">true</option>
                <option value="false">false</option>
              </select>
            </label>
            <label class="full">
              Tags (JSON array)
              <textarea name="tags" rows="2">[]</textarea>
            </label>
            <label class="full">
              Operation IDs (JSON array)
              <textarea name="operation_ids" rows="3">[]</textarea>
            </label>
            <label class="full">
              Auth Config (JSON)
              <textarea name="auth_config" rows="4">{}</textarea>
            </label>
            <label class="full">
              Metadata (JSON)
              <textarea name="metadata" rows="4">{}</textarea>
            </label>
            <label class="full">
              MCP Server URL (for MCP tools)
              <input name="mcp_server_url" placeholder="https://mcp-server" />
            </label>
            <label>
              Credential ID
              <input name="credential_id" type="number" />
            </label>
            <label>
              Credential Name
              <input name="credential_name" />
            </label>
            <label>
              Credential Environment
              <input name="credential_environment" placeholder="production" />
            </label>
          </div>
          <div class="modal-actions">
            <button type="submit" class="primary-btn">Save tool</button>
            <button type="button" id="deleteTool" class="danger-btn hidden">
              Delete
            </button>
          </div>
          <p id="formError" class="form-error hidden"></p>
        </form>
      </div>
    </div>

    <script src="./app.js"></script>
  </body>
</html>
